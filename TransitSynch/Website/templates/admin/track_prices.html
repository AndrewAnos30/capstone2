{% extends "header.html" %}
{% block content %}
<h1>Track Prices</h1>

<div class="table-container">
  <div class="table">
    <h2>Diesl Price</h2>
    <table>
      <tr>
        <td><strong>Date:</strong></td>
        <td>{{ date }}</td>
      </tr>
      <tr>
        <td><strong>Price in PHP:</strong></td>
        <td>{{ php_price }}</td>
      </tr>
      <tr>
        <td><strong>Price in USD:</strong></td>
        <td>{{ usd_price }}</td>
      </tr>
      <tr>
        <td><form method="post" action="{% url 'save_data' %}">
            {% csrf_token %}
            <input type="hidden" name="date" value="{{ date }}">
            <input type="hidden" name="php_price" value="{{ php_price }}">
            <input type="hidden" name="usd_price" value="{{ usd_price }}">
            <button type="submit">Save Data</button>
        </form></td>
        <td></td>
      </tr>
    </table>
  </div>

  <div class="table">
    <h2>Current Prices</h2>
    <table>
      <tr>
        <td><strong>Current Date:</strong></td>
        <td>{{ latest_price.CurrentDate }}</td>
      </tr>
      <tr>
        <td><strong>Current Fare:</strong></td>
        <td>{{ latest_price.CurrentFare }}</td>
      </tr>
      <tr>
        <td><strong>Current Diesel:</strong></td>
        <td>{{ latest_price.CurrentDiesel }}</td>
      </tr>
      <tr>
        <td><strong>Current Succeeding:</strong></td>
        <td>{{ latest_price.CurrentSucceeding }}</td>
      </tr>
      <tr>
        <td><strong><button id="show-update-prices-button" onclick="toggleUpdatePricesForm()">Show Update Prices Form</button>
        </strong></td>
        <td></td>
      </tr>
    </table>
  </div>
<div class="table">
  <h2>Calculation</h2>
  <table>
    {% if calculation_result is not None %}
      <tr>
        <td><strong>Calculation Result:</strong></td>
        <td>{{ calculation_result }}</td>
      </tr>
    {% endif %}
  
    {% if second_calculation_result is not None %}
      <tr>
        <td><strong>Calculation Result 2:</strong></td>
        <td>{{ second_calculation_result }}</td>
      </tr>
    {% endif %}
  
    {% if third_calculation_result is not None %}
      <tr>
        <td><strong>Calculation Result 3 (Second x CurrentFare):</strong></td>
        <td>{{ third_calculation_result|floatformat:2 }}</td>
      </tr>
    {% endif %}
  
    <!-- Display the fourth calculation result if it exists with 2 decimal points -->
    {% if fourth_calculation_result is not None %}
      <tr>
        <td><strong>Calculation Result 4 (Second x CurrentSucceeding):</strong></td>
        <td>{{ fourth_calculation_result|default:"N/A"|floatformat:2 }}</td>
      </tr>
    {% endif %}
  </table>
</div>

</div>


<!-- Modal container initially hidden -->
<div id="modal-container" class="modal-container">
    <div class="modal-content">
        <h1>Update Prices</h1>
        <form method="post" action="{% url 'update_prices' %}">
            {% csrf_token %}
            <label for="new_fare">New Fare:</label>
            <input type="number" name="new_fare" step="0.01" required>
            <br>
            <label for="new_succeeding">New Succeeding:</label>
            <input type="number" name="new_succeeding" step="0.01" required>
            <br>
            <label for="new_diesel">Diesel Price:</label>
            <input type="number" name="new_diesel" step="0.01" required>
            <br>
            <input type="submit" value="Update Prices">
            
            
        </form>
        <button onclick="closeModal()" class="close-button">X</button>
    </div>
</div>

<script>
    function toggleUpdatePricesForm() {
        var modalContainer = document.getElementById("modal-container");
        modalContainer.style.display = "block";
    }

    function closeModal() {
        var modalContainer = document.getElementById("modal-container");
        modalContainer.style.display = "none";
    }
</script>


<style>
  /* ... Your existing styles ... */
  .close-button {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: #555;
  }
</style>


<style>

.modal-container {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
        background-color: #fff;
        width: 50%;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #ccc;
    }
    
  .table-container {
    display: flex;
    justify-content: space-between;
  }

  .table {
    flex: 1;
    margin: 10px;
    padding: 10px;
    border: 1px solid #ccc;
  }

  table {
    width: 100%;
  }
</style>
</div>

{% endblock content %}
